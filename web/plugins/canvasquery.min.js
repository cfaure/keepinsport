/*     
  Canvas Query 0.9.0 work in progress
  http://canvasquery.com
  (c) 2012-2013 http://rezoner.net
  Canvas Query may be freely distributed under the MIT license.
*/

(function(m,s){/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent);m.requestAnimationFrame=m.requestAnimationFrame||m.webkitRequestAnimationFrame||m.mozRequestAnimationFrame||m.oRequestAnimationFrame||m.msRequestAnimationFrame||function(a){m.setTimeout(a,1E3/60)};var g=function(a){if(0===arguments.length){var c=g.createCanvas(m.innerWidth,m.innerHeight);m.addEventListener("resize",function(){})}else if("string"===typeof a)c=document.querySelector(a);else if("number"===typeof a)c=
g.createCanvas(arguments[0],arguments[1]);else if(a instanceof Image||a instanceof HTMLImageElement)c=g.createCanvas(a);else{if(a instanceof g.Wrapper)return a;c=a}return new g.Wrapper(c)};g.extend=function(){for(var a=1;a<arguments.length;a++)for(var c in arguments[a])arguments[0][c]=arguments[a][c];return arguments[0]};g.augment=function(){for(var a=1;a<arguments.length;a++)_.extend(arguments[0],arguments[a]),arguments[a](arguments[0])};g.distance=function(a,c,b,d){if(2<arguments.length){var f=
a-b,e=c-d;return Math.sqrt(f*f+e*e)}return Math.abs(a-c)};g.extend(g,{keycodes:{37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete",8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"escape",32:"space",33:"pageup",34:"pagedown",35:"end",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scrolllock",186:"semicolon",187:"equal",188:"comma",189:"dash",190:"period",191:"slash",
192:"graveaccent",219:"openbracket",220:"backslash",221:"closebraket",222:"singlequote"},cleanArray:function(a,c){for(var b=arguments[arguments.length-1],d="function"===typeof b,f=0,e=a.length;f<e;f++)if(null===a[f]||c&&a[f][c])d&&b(a[f]),a.splice(f--,1),e--},specialBlendFunctions:["color","value","hue","saturation"],blendFunctions:{normal:function(a,c){return c},overlay:function(a,c){a/=255;c/=255;return Math.min(255,Math.max(0,255*(0.5>a?2*a*c:1-2*(1-a)*(1-c))|0))},hardLight:function(a,c){return g.blendFunctions.overlay(c,
a)},softLight:function(a,c){a/=255;c/=255;return g.limitValue(255*((1-2*c)*a*a+2*c*a),0,255)},dodge:function(a,c){return Math.min(256*a/(255-c+1),255)},burn:function(a,c){return 255-Math.min(256*(255-a)/(c+1),255)},multiply:function(a,c){return c*a/255},divide:function(a,c){return Math.min(256*a/(c+1),255)},screen:function(a,c){return 255-(255-c)*(255-a)/255},grainExtract:function(a,c){return g.limitValue(a-c+128,0,255)},grainMerge:function(a,c){return g.limitValue(a+c-128,0,255)},difference:function(a,
c){return Math.abs(a-c)},addition:function(a,c){return Math.min(a+c,255)},substract:function(a,c){return Math.max(a-c,0)},darkenOnly:function(a,c){return Math.min(a,c)},lightenOnly:function(a,c){return Math.max(a,c)},color:function(a,c){var b=g.rgbToHsl(a),d=g.rgbToHsl(c);return g.hslToRgb(d[0],d[1],b[2])},hue:function(a,c){var b=g.rgbToHsv(a),d=g.rgbToHsv(c);return d[1]?g.hsvToRgb(d[0],b[1],b[2]):g.hsvToRgb(b[0],b[1],b[2])},value:function(a,c){var b=g.rgbToHsv(a),d=g.rgbToHsv(c);return g.hsvToRgb(b[0],
b[1],d[2])},saturation:function(a,c){var b=g.rgbToHsv(a),d=g.rgbToHsv(c);return g.hsvToRgb(b[0],d[1],b[2])}},blend:function(a,c,b,d){"undefined"===typeof d&&(d=1);a=g(a);c=g(c);var f=c.context,e=a.context.getImageData(0,0,a.canvas.width,a.canvas.height);c=f.getImageData(0,0,c.canvas.width,c.canvas.height);e=e.data;c=c.data;var f=this.createImageData(a.canvas.width,a.canvas.height),h=f.data,k=g.blendFunctions[b];if(-1!==g.specialBlendFunctions.indexOf(b)){b=0;for(var j=e.length;b<j;b+=4){var l=k([e[b+
0],e[b+1],e[b+2]],[c[b+0],c[b+1],c[b+2]]);h[b+0]=e[b+0]+(l[0]-e[b+0])*d;h[b+1]=e[b+1]+(l[1]-e[b+1])*d;h[b+2]=e[b+2]+(l[2]-e[b+2])*d;h[b+3]=e[b+3]}}else{b=0;for(j=e.length;b<j;b+=4){var l=k(e[b+0],c[b+0]),n=k(e[b+1],c[b+1]),m=k(e[b+2],c[b+2]);h[b+0]=e[b+0]+(l-e[b+0])*d;h[b+1]=e[b+1]+(n-e[b+1])*d;h[b+2]=e[b+2]+(m-e[b+2])*d;h[b+3]=e[b+3]}}a.context.putImageData(f,0,0);return a},wrapValue:function(a,c,b){b=Math.abs(b-c);return c+(a-c)%b},limitValue:function(a,c,b){return a<c?c:a>b?b:a},mix:function(a,
c,b){return a+(c-a)*b},hexToRgb:function(a){return 7===a.length?["0x"+a[1]+a[2]|0,"0x"+a[3]+a[4]|0,"0x"+a[5]+a[6]|0]:["0x"+a[1]|0,"0x"+a[2],"0x"+a[3]|0]},rgbToHex:function(a,c,b){return"#"+(16777216+(a<<16)+(c<<8)+b).toString(16).slice(1,7)},rgbToHsl:function(a,c,b){a instanceof Array&&(b=a[2],c=a[1],a=a[0]);a/=255;c/=255;b/=255;var d=Math.max(a,c,b),f=Math.min(a,c,b),e,h=(d+f)/2;if(d==f)e=f=0;else{var g=d-f,f=0.5<h?g/(2-d-f):g/(d+f);switch(d){case a:e=(c-b)/g+(c<b?6:0);break;case c:e=(b-a)/g+2;break;
case b:e=(a-c)/g+4}e/=6}return[e,f,h]},hslToRgb:function(a,c,b){if(0==c)b=c=a=b;else{var d=function(a,b,c){0>c&&(c+=1);1<c&&(c-=1);return c<1/6?a+6*(b-a)*c:0.5>c?b:c<2/3?a+6*(b-a)*(2/3-c):a},f=0.5>b?b*(1+c):b+c-b*c,e=2*b-f;b=d(e,f,a+1/3);c=d(e,f,a);a=d(e,f,a-1/3)}return[255*b|0,255*c|0,255*a|0]},rgbToHsv:function(a,c,b){a instanceof Array&&(b=a[2],c=a[1],a=a[0]);a/=255;c/=255;b/=255;var d=Math.max(a,c,b),f=Math.min(a,c,b),e,h=d-f;if(d==f)e=0;else{switch(d){case a:e=(c-b)/h+(c<b?6:0);break;case c:e=
(b-a)/h+2;break;case b:e=(a-c)/h+4}e/=6}return[e,0==d?0:h/d,d]},hsvToRgb:function(a,c,b){var d,f,e,h=Math.floor(6*a),g=6*a-h;a=b*(1-c);var j=b*(1-g*c);c=b*(1-(1-g)*c);switch(h%6){case 0:d=b;f=c;e=a;break;case 1:d=j;f=b;e=a;break;case 2:d=a;f=b;e=c;break;case 3:d=a;f=j;e=b;break;case 4:d=c;f=a;e=b;break;case 5:d=b,f=a,e=j}return[255*d|0,255*f|0,255*e|0]},color:function(a,c){var b=new g.Color;b.parse(a,c);return b},createCanvas:function(a,c){var b=document.createElement("canvas");a instanceof Image||
a instanceof HTMLImageElement?(b.width=a.width,b.height=a.height,b.getContext("2d").drawImage(a,0,0)):(b.width=a,b.height=c);return b},createImageData:function(a,c){return document.createElement("Canvas").getContext("2d").createImageData(a,c)},mousePosition:function(a){var c=0,b=0,d=a.target||a.srcElement,f=0,e=0;do c+=d.offsetLeft,b+=d.offsetTop;while(d=d.offsetParent);a.changedTouches&&a.changedTouches[0]!==s&&(a=a.changedTouches[0]);if(a.pageX||a.pageY)f=a.pageX,e=a.pageY;else if(a.clientX||a.clientY)f=
a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,e=a.clientY+document.body.scrollTop+document.documentElement.scrollTop;return{x:f-c,y:e-b}}});g.Wrapper=function(a){this.context=a.getContext("2d");this.canvas=a};g.Wrapper.prototype={appendTo:function(a){("object"===typeof a?a:document.querySelector(a)).appendChild(this.canvas);return this},blendOn:function(a,c,b){g.blend(a,this,c,b);return this},blend:function(a,c,b){if("string"===typeof a){var d=a;a=g(g.createCanvas(this.canvas.width,
this.canvas.height));a.fillStyle(d).fillRect(0,0,this.canvas.width,this.canvas.height)}g.blend(this,a,c,b);return this},circle:function(a,c,b){this.context.arc(a,c,b,0,2*Math.PI);return this},crop:function(a,c,b,d){var f=g.createCanvas(b,d);f.getContext("2d").drawImage(this.canvas,a,c,b,d,0,0,b,d);this.canvas.width=b;this.canvas.height=d;this.clear();this.context.drawImage(f,0,0);return this},set:function(a){g.extend(this.context,a)},resize:function(a,c){var b=a,d=c;1===arguments.length?(b=arguments[0]*
this.canvas.width|0,d=arguments[0]*this.canvas.height|0):null===c?this.canvas.width>a?(d=this.canvas.height*(a/this.canvas.width)|0,b=a):(b=this.canvas.width,d=this.canvas.height):null===a&&(this.canvas.width>a?(b=this.canvas.width*(c/this.canvas.height)|0,d=c):(b=this.canvas.width,d=this.canvas.height));b=g(b,d).drawImage(this.canvas,0,0,this.canvas.width,this.canvas.height,0,0,b,d);this.canvas=b.canvas;this.context=b.context;return this},trim:function(a,c){var b;a?(a=g.color(a).toArray(),b=!a[3]):
b=!0;for(var d=this.context.getImageData(0,0,this.canvas.width,this.canvas.height).data,f=[this.canvas.width,this.canvas.height,0,0],e=0,h=d.length;e<h;e+=4){if(b){if(!d[e+3])continue}else if(d[e+0]===a[0]&&d[e+1]===a[1]&&d[e+2]===a[2])continue;var k=(e/4|0)%this.canvas.width|0,j=(e/4|0)/this.canvas.width|0;k<f[0]&&(f[0]=k);k>f[2]&&(f[2]=k);j<f[1]&&(f[1]=j);j>f[3]&&(f[3]=j)}0===f[2]||0===f[3]||(c&&(c.left=f[0],c.top=f[1],c.width=f[2]-f[0],c.height=f[3]-f[1]),this.crop(f[0],f[1],f[2]-f[0]+1,f[3]-f[1]+
1));return this},resizePixel:function(a){var c=this.context.getImageData(0,0,this.canvas.width,this.canvas.height).data,b=document.createElement("canvas"),d=b.context=b.getContext("2d");b.width=this.canvas.width*a|0;b.height=this.canvas.height*a|0;for(var f=0,e=c.length;f<e;f+=4)c[f+3]&&(d.fillStyle=g.rgbToHex(c[f+0],c[f+1],c[f+2]),d.fillRect(f/4%this.canvas.width*a,(f/4/this.canvas.width|0)*a,a,a));this.canvas.width=b.width;this.canvas.height=b.height;this.clear().drawImage(b,0,0);return this},matchPalette:function(a){for(var c=
this.context.getImageData(0,0,this.canvas.width,this.canvas.height),b=[],d=0;d<a.length;d++)b.push(g.color(a[d]));for(d=0;d<c.data.length;d+=4){for(var f=[],e=0;e<b.length;e++){var h=b[e],k=Math.abs(c.data[d]-h[0]),j=Math.abs(c.data[d+1]-h[1]),h=Math.abs(c.data[d+2]-h[2]);f.push(k+j+h)}for(e=k=0;e<a.length;e++)f[e]<f[k]&&(k=e);f=cq.hexToRgb(a[k]);c.data[d]=f[0];c.data[d+1]=f[1];c.data[d+2]=f[2]}this.context.putImageData(c,0,0);return this},getPalette:function(){for(var a=[],c=this.context.getImageData(0,
0,this.canvas.width,this.canvas.height).data,b=0,d=c.length;b<d;b+=4)if(c[b+3]){var f=g.rgbToHex(c[b+0],c[b+1],c[b+2]);-1===a.indexOf(f)&&a.push(f)}return a},pixelize:function(a){if(!a)return this;var c=this.context.mozImageSmoothingEnabled,b=this.context.webkitImageSmoothingEnabled;this.context.mozImageSmoothingEnabled=!1;this.context.webkitImageSmoothingEnabled=!1;a=this.canvas.width/(a||4)/this.canvas.width;var d=cq(this.canvas.width,this.canvas.height);d.drawImage(this.canvas,0,0,this.canvas.width,
this.canvas.height,0,0,this.canvas.width*a|0,this.canvas.height*a|0);this.clear().drawImage(d.canvas,0,0,this.canvas.width*a|0,this.canvas.height*a|0,0,0,this.canvas.width,this.canvas.height);this.context.mozImageSmoothingEnabled=c;this.context.webkitImageSmoothingEnabled=b;return this},colorToMask:function(a,c){a=g.color(a).toArray();for(var b=this.context.getImageData(0,0,this.canvas.width,this.canvas.height).data,d=[],f=0,e=b.length;f<e;f+=4)b[f+0]==a[0]&&b[f+1]==a[1]&&b[f+2]==a[2]?d.push(c||!1):
d.push(!c);return d},grayscaleToMask:function(a){g.color(a).toArray();a=this.context.getImageData(0,0,this.canvas.width,this.canvas.height).data;for(var c=[],b=0,d=a.length;b<d;b+=4)c.push((a[b+0]+a[b+1]+a[b+2])/3|0);return c},grayscaleToAlpha:function(){for(var a=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),c=a.data,b=0,d=c.length;b<d;b+=4)c[b+3]=(c[b+0]+c[b+1]+c[b+2])/3|0,c[b+0]=c[b+1]=c[b+2]=255;this.context.putImageData(a,0,0);return this},applyMask:function(a){for(var c=
this.context.getImageData(0,0,this.canvas.width,this.canvas.height),b=c.data,d="boolean"===typeof a[0]?"bool":"byte",f=0,e=b.length;f<e;f+=4){var h=a[f/4];b[f+3]="bool"===d?255*h|0:h|0}this.context.putImageData(c,0,0);return this},fillMask:function(a){var c=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),b=c.data,d="boolean"===typeof a[0]?"bool":"byte",f=2===arguments.length?"normal":"gradient",e=g.color(arguments[1]);"gradient"===f&&(colorB=g.color(arguments[2]));for(var h=0,
k=b.length;h<k;h+=4){var j=a[h/4];"byte"===d&&(j/=255);"normal"===f?j&&(b[h+0]=e[0]|0,b[h+1]=e[1]|0,b[h+2]=e[2]|0,b[h+3]=255*j|0):(b[h+0]=e[0]+(colorB[0]-e[0])*j|0,b[h+1]=e[1]+(colorB[1]-e[1])*j|0,b[h+2]=e[2]+(colorB[2]-e[2])*j|0,b[h+3]=255)}this.context.putImageData(c,0,0);return this},clear:function(a){a?(this.context.fillStyle=a,this.context.fillRect(0,0,this.canvas.width,this.canvas.height)):this.context.clearRect(0,0,this.canvas.width,this.canvas.height);return this},clone:function(){var a=g.createCanvas(this.canvas.width,
this.canvas.height);a.getContext("2d").drawImage(this.canvas,0,0);return g(a)},fillStyle:function(a){this.context.fillStyle=a;return this},strokeStyle:function(a){this.context.strokeStyle=a;return this},gradientText:function(a,c,b,d,f){var e=a.split(" "),h=2*this.font().match(/\d+/g)[0],g=0,j=0;if(d)for(var j=0,l=[""],n=0;n<e.length;n++){a=e[n]+" ";var m=this.context.measureText(a).width;g+m>d&&(l[++j]="",g=0);l[j]+=a;g+=m}else l=[a];for(n=0;n<l.length;n++){j=b+0.6*n*h|0;d=this.context.createLinearGradient(0,
j,0,j+0.6*h|0);for(e=0;e<f.length;e+=2)d.addColorStop(f[e],f[e+1]);a=l[n];this.fillStyle(d).fillText(a,c,j)}return this},setHsl:function(){var a=1===arguments.length?arguments[0]:arguments,c=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),b=c.data,d,f,e;e=[];d=[];for(var h=0,k=b.length;h<k;h+=4)e=g.rgbToHsl(b[h+0],b[h+1],b[h+2]),d=null===a[0]?e[0]:g.limitValue(a[0],0,1),f=null===a[1]?e[1]:g.limitValue(a[1],0,1),e=null===a[2]?e[2]:g.limitValue(a[2],0,1),d=g.hslToRgb(d,f,e),b[h+
0]=d[0],b[h+1]=d[1],b[h+2]=d[2];this.context.putImageData(c,0,0);return this},shiftHsl:function(){var a=1===arguments.length?arguments[0]:arguments,c=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),b=c.data,d,f,e;e=[];d=[];for(var h=0,k=b.length;h<k;h+=4)e=g.rgbToHsl(b[h+0],b[h+1],b[h+2]),d=null===a[0]?e[0]:g.wrapValue(e[0]+a[0],0,1),f=null===a[1]?e[1]:g.limitValue(e[1]+a[1],0,1),e=null===a[2]?e[2]:g.limitValue(e[2]+a[2],0,1),d=g.hslToRgb(d,f,e),b[h+0]=d[0],b[h+1]=d[1],b[h+2]=
d[2];this.context.putImageData(c,0,0);return this},replaceHue:function(a,c){var b=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),d=b.data,f,e=[];f=[];for(var h=0,k=d.length;h<k;h+=4)e=g.rgbToHsl(d[h+0],d[h+1],d[h+2]),f=0.05>Math.abs(e[0]-a)?g.wrapValue(c,0,1):e[0],f=g.hslToRgb(f,e[1],e[2]),d[h+0]=f[0],d[h+1]=f[1],d[h+2]=f[2];this.context.putImageData(b,0,0);return this},invert:function(){for(var a=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),c=a.data,b=
0,d=c.length;b<d;b+=4)c[b+0]=255-c[b+0],c[b+1]=255-c[b+1],c[b+2]=255-c[b+2];this.context.putImageData(a,0,0);return this},roundRect:function(a,c,b,d,f){this.beginPath();this.moveTo(a+f,c);this.lineTo(a+b-f,c);this.quadraticCurveTo(a+b,c,a+b,c+f);this.lineTo(a+b,c+d-f);this.quadraticCurveTo(a+b,c+d,a+b-f,c+d);this.lineTo(a+f,c+d);this.quadraticCurveTo(a,c+d,a,c+d-f);this.lineTo(a,c+f);this.quadraticCurveTo(a,c,a+f,c);this.closePath();return this},wrappedText:function(a,c,b,d,f){var e=a.split(" "),
h=2*this.font().match(/\d+/g)[0],g=0,j=0;if(d){a=0;for(var l=[""],n=0;n<e.length;n++){var j=e[n]+" ",m=this.context.measureText(j).width;g+m>d&&(l[++a]="",g=0);l[a]+=j;g+=m}}else l=[a];for(n=0;n<l.length;n++)j=b+0.6*n*h|0,a=l[n],f&&f.call(this,c,b+j),this.fillText(a,c,j);return this},textBoundaries:function(a,c){var b=a.split(" "),d=2*this.font().match(/\d+/g)[0],f=0;if(c)for(var e=0,g=[""],k=0;k<b.length;k++){var j=b[k]+" ",l=this.context.measureText(j).width;f+l>c&&(g[++e]="",f=0);g[e]+=j;f+=l}else g=
[a],c=this.measureText(a).width;return{height:0.6*g.length*d|0,width:c}},paperBag:function(a,c,b,d,f,e){this.beginPath();this.moveTo(a,c);this.quadraticCurveTo(a+b/2|0,c+d*e|0,a+b,c);this.quadraticCurveTo(a+b-b*f|0,c+d/2|0,a+b,c+d);this.quadraticCurveTo(a+b/2|0,c+d-d*e|0,a,c+d);this.quadraticCurveTo(a+b*f|0,c+d/2|0,a,c)},borderImage:function(a,c,b,d,f,e,g,k,j,l){this.drawImage(a,j,0,a.width-j-g,e,c+j,b,d-j-g,e);this.drawImage(a,j,a.height-k,a.width-j-g,k,c+j,b+f-k,d-j-g,k);this.drawImage(a,0,e,j,
a.height-k-e,c,b+e,j,f-k-e);this.drawImage(a,a.width-g,e,g,a.height-k-e,c+d-g,b+e,g,f-k-e);this.drawImage(a,0,0,j,e,c,b,j,e);this.drawImage(a,a.width-g,0,g,e,c+d-g,b,g,e);this.drawImage(a,a.width-g,a.height-k,g,k,c+d-g,b+f-k,g,k);this.drawImage(a,0,a.height-k,j,k,c,b+f-k,j,k);l&&("string"===typeof l?this.fillStyle(l).fillRect(c+j,b+e,d-j-g,f-e-k):this.drawImage(a,j,e,a.width-g-j,a.height-k-e,c+j,b+e,d-j-g,f-e-k))},measureText:function(){return this.context.measureText.apply(this.context,arguments)},
createRadialGradient:function(){return this.context.createRadialGradient.apply(this.context,arguments)},createLinearGradient:function(){return this.context.createLinearGradient.apply(this.context,arguments)},getImageData:function(){return this.context.getImageData.apply(this.context,arguments)}};for(var r="arc arcTo beginPath bezierCurveTo clearRect clip closePath createImageData createLinearGradient createRadialGradient createPattern drawFocusRing drawImage fill fillRect fillText getImageData isPointInPath lineTo measureText moveTo putImageData quadraticCurveTo rect restore rotate save scale setTransform stroke strokeRect strokeText transform translate".split(" "),
q=0;q<r.length;q++){var p=r[q];g.Wrapper.prototype[p]||(g.Wrapper.prototype[p]=Function("this.context."+p+".apply(this.context, arguments); return this;"))}r="canvas fillStyle font globalAlpha globalCompositeOperation lineCap lineJoin lineWidth miterLimit shadowOffsetX shadowOffsetY shadowBlur shadowColor strokeStyle textAlign textBaseline".split(" ");for(q=0;q<r.length;q++)p=r[q],g.Wrapper.prototype[p]||(g.Wrapper.prototype[p]=Function("if(arguments.length) { this.context."+p+" = arguments[0]; return this; } else { return this.context."+
p+"; }"));g.Color=function(a,c){arguments.length&&this.parse(a)};g.Color.prototype={parse:function(a,c){if(a[0]instanceof g.Color)this[0]=a[0][0],this[1]=a[0][1],this[2]=a[0][2],this[3]=a[0][3];else if("string"===typeof a){var b=null;"#"===a[0]?(b=g.hexToRgb(a),this[0]=b[0],this[1]=b[1],this[2]=b[2],this[3]=1):(b=a.match(/rgb\((.*),(.*),(.*)\)/))?(this[0]=b[1]|0,this[1]=b[2]|0,this[2]=b[3]|0,this[3]=1):(b=a.match(/rgba\((.*),(.*),(.*)\)/))?(this[0]=b[1]|0,this[1]=b[2]|0,this[2]=b[3]|0,this[3]=b[4]|
0):(b=a.match(/hsl\((.*),(.*),(.*)\)/))?this.fromHsl(b[1],b[2],b[3]):(b=a.match(/hsv\((.*),(.*),(.*)\)/))&&this.fromHsv(b[1],b[2],b[3])}else switch(c){case "hsl":case "hsla":this.fromHsl(a[0],a[1],a[2],a[3]);break;case "hsv":case "hsva":this.fromHsv(a[0],a[1],a[2],a[3]);break;default:this[0]=a[0],this[1]=a[1],this[2]=a[2],this[3]="undefined"===typeof a[3]?1:a[3]}},fromHsl:function(){var a=arguments[0]instanceof Array?arguments[0]:arguments,a=g.hslToRgb(a[0],a[1],a[2]);this[0]=a[0];this[1]=a[1];this[2]=
a[2];this[3]="undefined"===typeof arguments[3]?1:arguments[3]},fromHsv:function(){var a=arguments[0]instanceof Array?arguments[0]:arguments,a=g.hsvToRgb(a[0],a[1],a[2]);this[0]=a[0];this[1]=a[1];this[2]=a[2];this[3]="undefined"===typeof arguments[3]?1:arguments[3]},toArray:function(){return[this[0],this[1],this[2],this[3]]},toRgb:function(){return"rgb("+this[0]+", "+this[1]+", "+this[2]+")"},toRgba:function(){return"rgba("+this[0]+", "+this[1]+", "+this[2]+", "+this[3]+")"},toHex:function(){return g.rgbToHex(this[0],
this[1],this[2])},toHsl:function(){var a=g.rgbToHsl(this[0],this[1],this[2]);a[3]=this[3];return a},toHsv:function(){var a=g.rgbToHsv(this[0],this[1],this[2]);a[3]=this[3];return a},gradient:function(a){g.color(a)},shiftHsl:function(a,c,b){var d=this.toHsl();a=null===a?d[0]:g.wrapValue(d[0]+a,0,1);c=null===c?d[1]:g.limitValue(d[1]+c,0,1);b=null===b?d[2]:g.limitValue(d[2]+b,0,1);this.fromHsl(a,c,b);return this},setHsl:function(a,c,b){var d=this.toHsl();a=null===a?d[0]:g.limitValue(a,0,1);c=null===
c?d[1]:g.limitValue(c,0,1);b=null===b?d[2]:g.limitValue(b,0,1);this.fromHsl(a,c,b);return this}};m.cq=m.CanvasQuery=g;"function"===typeof define&&define.amd&&define([],function(){return g})})(window);